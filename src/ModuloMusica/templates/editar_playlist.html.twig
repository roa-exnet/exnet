{% extends 'base.html.twig' %}

{% block title %}Editar Playlist - Música Exnet{% endblock %}

{% block head %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('/moduloMusica/css/playlist.css') }}">
{% endblock %}

{% block body %}
<div class="exnet-container-transparent p-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="exnet-main-title">Editar Playlist</h1>
        <div>
            <a href="{{ path('musica_playlist_detalle', {'id': playlist.id}) }}" class="exnet-btn-small">
                <i class="fas fa-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    <div class="form-container">
        <h2 class="form-title">Editar "{{ playlist.nombre }}"</h2>
        
        <form method="post" action="{{ path('musica_playlist_editar', {'id': playlist.id}) }}" id="playlistForm">
            <div class="form-group">
                <label for="nombre" class="form-label">Nombre de la playlist *</label>
                <input type="text" id="nombre" name="nombre" class="form-control" required value="{{ playlist.nombre }}">
            </div>
            
            <div class="form-group">
                <label for="descripcion" class="form-label">Descripción</label>
                <textarea id="descripcion" name="descripcion" class="form-control">{{ playlist.descripcion }}</textarea>
            </div>
            
            <div class="form-group">
                <label for="imagenFile" class="form-label">Imagen de Portada</label>
                <input type="file" id="imagenFile" class="form-control" accept="image/png,image/jpeg,image/jpg,image/webp">
                <input type="hidden" id="imagenBase64" name="imagenBase64">
                <small class="text-muted">Formatos aceptados: PNG, JPG, WEBP (máx. 2MB)</small>
                
                <div id="imagePreviewContainer" class="preview-container" {% if not playlist.imagen %}style="display: none;"{% endif %}>
                    <img id="imagePreview" src="{{ playlist.imagen }}" alt="Preview" class="image-preview">
                </div>
                
                {% if playlist.imagen %}
                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" id="mantenerImagen" name="mantenerImagen" checked>
                    <label class="form-check-label" for="mantenerImagen">
                        Mantener la imagen actual si no se sube una nueva
                    </label>
                </div>
                {% endif %}
            </div>
            
            <div class="form-group">
                <label class="form-check-label">
                    <input type="checkbox" name="esPublica" class="form-check-input" {% if playlist.esPublica %}checked{% endif %}>
                    Playlist pública (visible para todos los usuarios)
                </label>
            </div>
            
            <div class="mt-4 text-end">
                <a href="{{ path('musica_playlist_detalle', {'id': playlist.id}) }}" class="btn-cancel">Cancelar</a>
                <button type="submit" class="btn-submit">Guardar Cambios</button>
            </div>
        </form>
    </div>
</div>

<script src="/moduloMusica/js/reproductor.js"></script>
{% endblock %}